# PqMvc-cocos

## 介绍
#### 这是典型的MVC框架
### 一、主要有以下几部分组成：
#####    1、com目录，主要存放封装的工具类或组件，这些工具类或组件是通用的，不局限于项目
#####    2、core目录，主要存放底层框架代码
#####    3、const目录，主要存放项目静态配置数据，比如版本号，语言，还有一些常量数值
#####    4、data目录、用于存放游戏配置表数据
#####    5、modules目录，用于存放模块的，所有的模块都会放在这个目录，一个模块一个子目录
#####    6、public目录，用于存放当前项目封装的通用的或公共的代码或工具类
#####    7、reg.ts文件，框架注册类，所有的模块都会在这个类中注册，也是框架的入口，只需要在项目入口实例化这个类就可以初始化框架。

### 二、框架架构：
#####    1、框架底层有EvMgr,PqMvc,PqMgr,PqCtl,PqPxy,PqUi,PqCmd这些组成。
#####    2、EvMgr是EventMgr的简写，功能就如名字一样，就是消息/事件管理类，也是框架一切通信的基础。里面包含消息/事件的注册，广播，删除等功能
#####    3、PqMvc是框架代码的基类，主要就是封装了EvMgr中的功能和一些基础的通用方法
#####    4、PqCmd是定义模块消息，模块之间通信主要通过Cmd来发送接收消息
#####    5、PqMgr是模块入口的基类，在reg中注册框架实际上就是在reg中实例化模块的Mgr，它主要负责实例化模块的Ctl，Pxy和注册模块监听的消息事件。外部所有的消息均需要通过此类才会被下发到Ctl或pxy
#####    6、PqCtl是模块的控制器，主要负责将外部消息或数据变更通知到UI进行更新。Ctl保存了ui和pxy的引用，可直接调用pxy和UI中开放的接口
#####    7、PqPxy是负责模块内部数据处理逻辑，包括与服务端的数据通信，外部数据转换等逻辑。可直接接收由Mgr传入的外部消息，数据更新后如果要通知到UI，可通过notify通知到ctl再由 ctl传给UI
#####    8、PqUi 直接绑定到预制体，直接操作UI变化，渲染。Ui所需的数据均必需由ctl传入。


### 三、模块结构：
#####    每个模块必然包含moduleMgr和moduleCmd，Mgr是入口，也是模块基础。至于其它的按需要注册。比如如果不需要进行数据处理，不需要与后端通信则不需要注册pxy，如果只需要处理数据，不需要其它UI和相应的逻辑，则只注册pxy即可，不需要注册ctl。
#####    1、moduleMgr(模块入口，管理类，负责注册模块内部各部分功能，这个类会常驻内存，以便实时接收消息) 
#####    2、moduleCtl(模块控制器，负责接收Mgr的消息并下发到Ui或Pxy，Ctl中有Ui和Pxy的引用，可直接调用) 
#####    3、modulePxy(模块数据管理器，负责处理模块内部数据逻辑和与后端通信相关逻辑，modulePxy中会存有模块的数据结构moduleModel来存储数据) 
#####    4、moduleUi（模块视图层，负责接收Ctl给过来的数据并显示到视图上) 
#####    5、moduleCmd（模块消息，负责定义模块监听和发送的消息）


### 四、其它说明
#####    1、modules目录下的base模块，这是所有模块的基类，包含baseMgr,baseCtl,basePxy,baseUi，其它模块均继承此模块下对应的基类。对于通用的逻辑功能需求可直接抽象到base模块中，避免直接改到框架底层。
#####    2、这只是开发框架，对应的工具类，自行使用自己收集封装的即可，如加载管理，缓存管理等。
#####    3、每个模块只有一个Mgr，但可以有N个Ctl,Pxy,Ui,Cmd，一般情况下不需要多个，只针对比较大的模块功能可自行进行扩展。

### 五、bundle分包
#####    1、框架默认不考虑代码分包，对于大多数中小游戏，代码量不超过4M，没有分包的必要。因此如果要按模块进行bundle分包，需要资源单独放一个目录进行分包。
#####    2、如果要将模块代码和资源一起打包，需要自行处理资源加载问题，然后在Ui中将Mgr中初始化，并将所有模块的Cmd单独抽出到公共包，以解决模块依赖问题。
